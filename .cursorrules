# Algreen Tracker - AI Coding Guidelines

This document provides rules and patterns for AI assistants (Claude, Cursor, Copilot, etc.) when generating code for this project.

## Tech Stack

- **Framework**: React 19 + TypeScript + Vite
- **Styling**: Tailwind CSS + shadcn/ui components
- **State Management**:
  - Server state: TanStack Query
  - Client state: Zustand
- **Forms**: React Hook Form + Zod validation
- **Routing**: React Router v7

## Project Structure

```
src/
├── components/          # Shared components
│   └── ui/             # shadcn/ui components (DO NOT modify manually)
├── config/             # App configuration
├── features/           # Feature modules (MAIN development area)
│   └── [feature]/
│       ├── components/ # Feature-specific components
│       ├── hooks/      # Feature-specific hooks
│       ├── pages/      # Page components
│       ├── services/   # API calls for this feature
│       ├── stores/     # Zustand stores for this feature
│       └── types/      # Feature-specific types
├── hooks/              # Shared custom hooks
├── layouts/            # Layout components
├── lib/                # Utility functions
├── routes/             # Route definitions
├── services/           # Shared API services
├── stores/             # Global Zustand stores
└── types/              # Shared TypeScript types
```

## Rules

### 1. Feature-Based Organization

ALWAYS create new functionality inside `src/features/[feature-name]/`:

```typescript
// CORRECT - Feature-based
src/features/users/
  ├── components/user-card.tsx
  ├── hooks/use-user.ts
  ├── pages/users-page.tsx
  ├── services/users-api.ts
  └── types/user.types.ts

// WRONG - Flat structure
src/components/UserCard.tsx
src/hooks/useUser.ts
src/pages/UsersPage.tsx
```

### 2. Naming Conventions

| Type | Convention | Example |
|------|------------|---------|
| Files | kebab-case | `user-profile.tsx` |
| Components | PascalCase | `UserProfile` |
| Hooks | camelCase with `use` prefix | `useUserProfile` |
| Utilities | camelCase | `formatDate` |
| Types/Interfaces | PascalCase | `UserProfile` |
| Constants | SCREAMING_SNAKE_CASE | `API_BASE_URL` |
| CSS classes | Tailwind utilities | `className="flex items-center"` |

### 3. Component Patterns

Always use functional components with TypeScript:

```typescript
// CORRECT
interface UserCardProps {
  user: User;
  onSelect?: (user: User) => void;
}

export function UserCard({ user, onSelect }: UserCardProps) {
  return (
    <div className="rounded-lg border bg-card p-4">
      {/* content */}
    </div>
  );
}

// WRONG - default export, no types
export default function({ user }) {
  return <div>{user.name}</div>;
}
```

### 4. Use shadcn/ui Components

ALWAYS prefer shadcn/ui components over custom implementations:

```typescript
// CORRECT - Use shadcn/ui
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Alert, AlertDescription } from '@/components/ui/alert';

<Button variant="destructive">Delete</Button>
<Alert variant="destructive">
  <AlertDescription>Error message</AlertDescription>
</Alert>

// WRONG - Custom implementations
<button className="bg-red-500 text-white px-4 py-2">Delete</button>
<div className="bg-red-100 text-red-700 p-4">Error message</div>
```

To add new shadcn/ui components:
```bash
npx shadcn-ui@latest add [component-name]
```

### 5. State Management

**Server State (TanStack Query)** - For data from APIs:

```typescript
// CORRECT - TanStack Query for server data
import { useQuery, useMutation } from '@tanstack/react-query';

export function useUsers() {
  return useQuery({
    queryKey: ['users'],
    queryFn: () => api.get<User[]>('/users'),
  });
}

export function useCreateUser() {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (data: CreateUserDto) => api.post('/users', data),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['users'] });
    },
  });
}
```

**Client State (Zustand)** - For UI state only:

```typescript
// CORRECT - Zustand for UI state
import { create } from 'zustand';

interface UIState {
  sidebarOpen: boolean;
  toggleSidebar: () => void;
}

export const useUIStore = create<UIState>((set) => ({
  sidebarOpen: true,
  toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),
}));
```

### 6. Form Handling

ALWAYS use React Hook Form + Zod:

```typescript
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';

const schema = z.object({
  email: z.string().email('Invalid email'),
  password: z.string().min(8, 'Password must be at least 8 characters'),
});

type FormData = z.infer<typeof schema>;

export function LoginForm() {
  const form = useForm<FormData>({
    resolver: zodResolver(schema),
  });

  const onSubmit = (data: FormData) => {
    // handle submit
  };

  return (
    <form onSubmit={form.handleSubmit(onSubmit)}>
      {/* form fields */}
    </form>
  );
}
```

### 7. Styling Rules

Use Tailwind CSS with these patterns:

```typescript
// CORRECT - Use semantic color classes
<div className="bg-background text-foreground">
<div className="bg-destructive text-destructive-foreground">
<div className="bg-success text-success-foreground">
<div className="text-muted-foreground">

// CORRECT - Use z-index variables
<div className="z-modal">
<div className="z-tooltip">
<div className="z-toast">

// WRONG - Hardcoded colors
<div className="bg-white text-black">
<div className="bg-red-500">
<div className="z-50">

// CORRECT - Use cn() for conditional classes
import { cn } from '@/lib/utils';

<div className={cn(
  "base-classes",
  isActive && "active-classes",
  variant === "primary" && "primary-classes"
)}>
```

### 8. CSS Variables Reference

**ALWAYS use these design tokens instead of hardcoded values:**

#### Colors (use Tailwind classes)
| Variable | Tailwind Class | Usage |
|----------|---------------|-------|
| `--background` | `bg-background` | Page backgrounds |
| `--foreground` | `text-foreground` | Primary text |
| `--card` | `bg-card` | Card backgrounds |
| `--primary` | `bg-primary`, `text-primary` | Primary actions, links |
| `--secondary` | `bg-secondary` | Secondary actions |
| `--muted` | `bg-muted`, `text-muted-foreground` | Subtle backgrounds, secondary text |
| `--accent` | `bg-accent` | Highlighted elements |
| `--destructive` | `bg-destructive` | Errors, delete actions |
| `--success` | `bg-success` | Success states |
| `--warning` | `bg-warning` | Warning states |
| `--info` | `bg-info` | Informational states |
| `--border` | `border-border` | Borders |
| `--input` | `border-input` | Input borders |
| `--ring` | `ring-ring` | Focus rings |

```typescript
// CORRECT
<div className="bg-background text-foreground" />
<button className="bg-primary text-primary-foreground" />
<span className="text-muted-foreground" />
<div className="bg-success text-success-foreground" />
<div className="bg-destructive text-destructive-foreground" />

// WRONG - Never use raw colors
<div className="bg-white text-black" />
<button className="bg-blue-500 text-white" />
<span className="text-gray-500" />
<div className="bg-green-500" />
<div className="bg-red-500" />
```

#### Z-Index Scale (use Tailwind classes)
| Variable | Tailwind Class | Value | Usage |
|----------|---------------|-------|-------|
| `--z-dropdown` | `z-dropdown` | 100 | Dropdown menus |
| `--z-sticky` | `z-sticky` | 200 | Sticky headers |
| `--z-fixed` | `z-fixed` | 300 | Fixed elements |
| `--z-modal-backdrop` | `z-modal-backdrop` | 400 | Modal overlays |
| `--z-modal` | `z-modal` | 500 | Modal content |
| `--z-popover` | `z-popover` | 600 | Popovers |
| `--z-tooltip` | `z-tooltip` | 700 | Tooltips |
| `--z-toast` | `z-toast` | 800 | Toast notifications |

```typescript
// CORRECT
<div className="z-modal" />
<div className="z-tooltip" />
<header className="z-sticky" />

// WRONG - Never use magic numbers
<div className="z-50" />
<div className="z-[9999]" />
```

#### Border Radius
| Variable | Tailwind Class | Value |
|----------|---------------|-------|
| `--radius-sm` | `rounded-sm` | 0.25rem |
| `--radius` | `rounded-md` | 0.5rem |
| `--radius-lg` | `rounded-lg` | 0.75rem |
| `--radius-xl` | `rounded-xl` | 1rem |

#### Shadows
| Variable | CSS Usage |
|----------|-----------|
| `--shadow-sm` | `shadow-sm` or `style={{ boxShadow: 'var(--shadow-sm)' }}` |
| `--shadow-md` | `shadow-md` |
| `--shadow-lg` | `shadow-lg` |

#### Transitions
| Variable | Value | Usage |
|----------|-------|-------|
| `--transition-fast` | 150ms | Hover states |
| `--transition-normal` | 200ms | Default transitions |
| `--transition-slow` | 300ms | Complex animations |

```typescript
// Usage in custom styles if needed
<div style={{ transitionDuration: 'var(--transition-normal)' }} />
```

#### Spacing (prefer Tailwind classes)
| Variable | Value | Tailwind Equivalent |
|----------|-------|---------------------|
| `--spacing-xs` | 0.25rem | `p-1`, `m-1`, `gap-1` |
| `--spacing-sm` | 0.5rem | `p-2`, `m-2`, `gap-2` |
| `--spacing-md` | 1rem | `p-4`, `m-4`, `gap-4` |
| `--spacing-lg` | 1.5rem | `p-6`, `m-6`, `gap-6` |
| `--spacing-xl` | 2rem | `p-8`, `m-8`, `gap-8` |
| `--spacing-2xl` | 3rem | `p-12`, `m-12`, `gap-12` |

### 9. Import Aliases

ALWAYS use the `@/` alias:

```typescript
// CORRECT
import { Button } from '@/components/ui/button';
import { useUsers } from '@/features/users/hooks/use-users';
import { cn } from '@/lib/utils';

// WRONG
import { Button } from '../../../components/ui/button';
import { useUsers } from './hooks/use-users';
```

### 10. API Calls

Use the shared API client:

```typescript
import { api } from '@/services/api';

// GET request
const users = await api.get<User[]>('/users');

// POST request
const newUser = await api.post<User>('/users', { name: 'John' });

// With query params
const filtered = await api.get<User[]>('/users', {
  params: { role: 'admin' },
});
```

### 11. Error Handling

Use proper error boundaries and display errors with shadcn/ui Alert:

```typescript
import { Alert, AlertDescription } from '@/components/ui/alert';
import { AlertCircle } from 'lucide-react';

{error && (
  <Alert variant="destructive">
    <AlertCircle className="h-4 w-4" />
    <AlertDescription>{error.message}</AlertDescription>
  </Alert>
)}
```

### 12. TypeScript Patterns

```typescript
// Use interface for object shapes
interface User {
  id: string;
  name: string;
  email: string;
}

// Use type for unions, intersections, utilities
type Status = 'pending' | 'active' | 'inactive';
type UserWithRole = User & { role: string };

// Always type function parameters and returns
function formatUser(user: User): string {
  return `${user.name} (${user.email})`;
}

// Use generic types for reusable components
interface ListProps<T> {
  items: T[];
  renderItem: (item: T) => React.ReactNode;
}
```

### 13. File Templates

When creating new features, follow this template:

**Page Component** (`features/[feature]/pages/[name]-page.tsx`):
```typescript
export function FeaturePage() {
  return (
    <div className="space-y-6">
      <h1 className="text-3xl font-bold">Page Title</h1>
      {/* content */}
    </div>
  );
}
```

**Hook** (`features/[feature]/hooks/use-[name].ts`):
```typescript
import { useQuery } from '@tanstack/react-query';
import { api } from '@/services/api';

export function useFeatureData() {
  return useQuery({
    queryKey: ['feature'],
    queryFn: () => api.get('/endpoint'),
  });
}
```

**Store** (`features/[feature]/stores/[name]-store.ts`):
```typescript
import { create } from 'zustand';

interface FeatureState {
  // state
}

export const useFeatureStore = create<FeatureState>((set) => ({
  // initial state and actions
}));
```

## Available Utilities

### `cn()` - Class name merger
```typescript
import { cn } from '@/lib/utils';
cn('base', condition && 'conditional', 'always');
```

### Format utilities (`@/lib/format`)
```typescript
import { formatDate, formatCurrency, formatRelativeTime } from '@/lib/format';
formatDate(new Date()); // "Dec 26, 2025"
formatCurrency(99.99); // "$99.99"
formatRelativeTime(date); // "2 hours ago"
```

### String utilities (`@/lib/string`)
```typescript
import { slugify, truncate, capitalize } from '@/lib/string';
slugify('Hello World'); // "hello-world"
truncate('Long text...', 10); // "Long te..."
capitalize('hello'); // "Hello"
```

### Hooks (`@/hooks`)
```typescript
import { useDebounce, useLocalStorage, useClickOutside, useMediaQuery } from '@/hooks';
```

## Don'ts

1. **DON'T** use inline styles - use Tailwind classes
2. **DON'T** create components outside of `features/` or `components/`
3. **DON'T** use `any` type - always provide proper types
4. **DON'T** use default exports (except for pages if needed by router)
5. **DON'T** store server data in Zustand - use TanStack Query
6. **DON'T** use native HTML form elements without React Hook Form
7. **DON'T** hardcode colors - use CSS variables via Tailwind
8. **DON'T** use magic z-index numbers - use `z-modal`, `z-tooltip`, etc.
9. **DON'T** modify files in `components/ui/` - they are managed by shadcn/ui
10. **DON'T** use relative imports when `@/` alias is available
